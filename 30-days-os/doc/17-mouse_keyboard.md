## 键盘鼠标

### 序
本章我们开始讲一下关于如何处理鼠标键盘，鼠标的很多设定也是包含在键盘的设定中，我们也是通过对外设的设定然后当鼠标按下或者键盘按键触发中断，再进一步执行中断处理函数，相信大家对这一套流程已经很熟悉了，接下来我们还是先大概说一下如何针对鼠标和键盘的端口进行设定吧。

### 知识储备
看到上边我们知道了也是通过中断来触发，同时可以跳到第八章的中断的PIC芯片上就有关于接收键盘和鼠标的信号，不过连接到PIC的还有另外的专门处理鼠标和键盘的外设，这个外设或者芯片和PIC进行沟通。所以我们就是要对这个芯片进行设定或者说初始化。<br/>
我们就需要看下这个芯片的结构：<br/>
这个设备最重要的组成部分是四个寄存器：<br/>
[图]
可以看到四个寄存器（均为8位宽）有两个端口，说明在不同场合下同一个端口的设定针对的是不同的寄存器。<br/>
先来看下这个**输入输出的寄存器**，他们的端口都是0x60，当处理器要往芯片写入数据时，0x60端口就是输入缓冲区。当处理器要从芯片读取数据，0x60端口就是控制输出缓冲区，那这里的输出和输入的概念自然就是相对于芯片来说的。我们会向输入缓冲区寄存器写入控制指令，我们后边写代码中会说到。<br/>
然后再看下**状态寄存器**，我们看下我们可能会用到的各个位的作用：
* 位0置1表示输出缓冲区寄存器已满，处理器可以通过in指令来读取，读取后自动置0
* 位1置1表示输入缓冲区寄存器已满，芯片将值读取后自动置0

最后看下**控制寄存器**：<br/>
* 位0置1表示启用键盘中断
* 位1置1表示启用鼠标中断
* 位4置1表示禁止键盘
* 位5置1表示禁止鼠标

别的位暂且不会用到，这里不展开讲<br/>
同样这里控制寄存器和状态寄存器使用的端口都是0x64，也是读取0x64是指状态寄存器，写入0x64是向控制寄存器中写入

### 代码
那么接下来我们就从代码中来理解了，

