## 图像显示

### 序
这一节我们来讲讲关于图像显示，我们之前（03讲）有说过，内存中有一部分是和显示图像有关，也即显存映射到内存的部分，我们如果要操作图像显示等，只需要操作这一块内存即可。


### 关于画面设定
我们在05节中穿插着关于画面设定的部分，我们借此再来回忆一下，我们使用VBE可以使用高分辨率的画面，首先回去判断显卡是否支持VBE。不支持或者版本小于2.0的话我们使用默认的320x200x8bit的彩色。如果支持的话我们就通过设定画面模式号码来选择一个画面模式，由于作者使用qemu来调试，所以最大的分辨率也就是1024*768的。
```
; 0x101  -> 640*480*8
; 0x103  -> 800*600*8
; 0x105  -> 1024*768*8
; 0x107  -> 1280*1024*8(QEMU中不能指定到0x107)
```
调用INT 10中断，BIOS就会把相关数据写入到[ES:DI]开始的256字节。然后就会获得了一系列的画面信息：
```
  ; 画面模式信息重要信息：
  ; WORD [ES:DI+0x00] 模式属性
  ; WORD [ES:DI+0x12] x的分辨率
  ; WORD [ES:DI+0x14] y的分辨率
  ; BYTE [ES:DI+0x19] 颜色数，必须是8
  ; BYTE [ES:DI+0x1b] 颜色指定方法，必须为4（调色板模式）
  ; DWORD [ES:DI+0x28] VRAM的地址
```
关键的有获取到的x，y分辨率，位数是8，颜色指定模式调色板模式，同时还获取到了VRAM的地址，也就是我们往这个地址中写入数据就会控制画面的显示了。
我们把这些重要的信息拿出来保存起来，再来列一下保存的位置：
```
; 有关BOOT_INFO存放地址
CYLS	EQU		0x0ff0			; 柱面数
LEDS	EQU		0x0ff1
VMODE	EQU		0x0ff2			; 关于颜色数目信息，颜色位数
SCRNX	EQU		0x0ff4			; 分辨率x
SCRNY	EQU		0x0ff6			; 分辨率x
VRAM	EQU		0x0ff8			; 存放图像缓冲区的开始地址
```
那么我们在06节已经知道，把这些数据通过地址转化为BOOTINFO的结构体对象，这样一来我们使用就方便很多了。

### 初始化调色板
